#1. Display all customers who live in 'Delhi'.
SELECT * FROM Customers WHERE city="Delhi";


#2. Find the average rating of all restaurants in 'Mumbai'.
select city, round(avg(rating),2) from Restaurants 
where city="Mumbai" group by city;

#3. List all customers who have placed at least one order.
select distinct customers.name from Customers 
inner join orders on Customers.customer_id=Orders.customer_id;

#4. Display the total number of orders placed by each customer.
select customers.name,count(orders.customer_id)
from customers left join Orders
on customers.customer_id=orders.customer_id
group by customers.name
    
#5. Find the total revenue generated by each restaurant.
select Restaurants.name, Sum(orders.total_amount) 
from Restaurants left join orders on Restaurants.restaurant_id=orders.restaurant_id 
group by restaurants.name;

#6. Find the top 5 restaurants with the highest average rating.
select name, rating from Restaurants
order by rating desc limit 5;

#7. Display all customers who have never placed an order.
select distinct Customers.name, Orders.order_id from Customers 
left join Orders on Customers.customer_id=Orders.customer_id where order_id is null;

#8. Find the number of orders placed by each customer in 'Mumbai'.
select distinct Customers.name, count(orders.customer_id) from Customers left join Orders ON
Customers.customer_id=Orders.customer_id
where city="Mumbai" group by Customers.name;
select customers.name,count(orders.customer_id) from customers left join orders orders
on customers.customer_id=orders.customer_id where city="Mumbai" group by customers.name;

#9. Display all orders placed in the last 30 days.
select *, datediff(now(), Order_date) as last_1800_days from Orders where datediff(now(), order_date)<=1800;


#10. Find the customers who have placed orders on exactly three different days.
select customers.name,count(distinct orders.order_date)
from customers join Orders
on customers.customer_id=orders.customer_id
group by customers.name
having count(distinct orders.order_date)=3;
